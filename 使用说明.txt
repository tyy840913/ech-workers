Usage of ech-workers:
  -dns string
        ECH 查询 DNS 服务器 (default "119.29.29.29:53")
  -ech string
        ECH 查询域名 (default "cloudflare-ech.com")
  -f string
        服务端地址 (格式: x.x.workers.dev:443)
  -ip string
        指定服务端 IP（绕过 DNS 解析）
  -l string
        SOCKS5 监听地址 (格式: [user:pass@]ip:port) (default "127.0.0.1:30000")
  -token string
        身份验证令牌

ech-workers -l 127.0.0.1:30000 -f purple-bar-cd06.fgrfdd.workers.dev:443 -ip www.udacity.com
ech-workers -f echlj.335885.xyz:443 -ip www.udacity.com








使用 Go 语言开发 Xray + VLESS 客户端，你需要了解 Xray 的核心概念，并使用 Go 语言的 v2ray-core 库或其超集 xray-core 的相关 API 来构建客户端逻辑。这涉及到解析 VLESS 协议配置，并通过 Go 语言的网络库实现与 Xray 服务器的通信，最终通过代理实现流量转发。 
核心步骤和要点：
理解协议和核心组件:
VLESS: 了解 VLESS 是一个无状态的轻量级传输协议，它将流量分成入站（Inbound）和出站（Outbound），并使用 UUID 进行身份验证，与 VMess 不同，它不依赖系统时间，并且不需要 alterId。
Xray: 这是 v2ray-core 的一个超集，在性能上有增强，并保持与 v2ray-core 的完全兼容性，它提供了 XTLS 等先进功能。
使用 Go 语言库:
导入 v2ray-core 或 xray-core: 使用 Go 语言的 go get 命令导入相关的库，例如 v2ray-core。
配置解析: 使用库提供的 API 来解析 VLESS 配置文件，通常是一个 JSON 格式的配置。
构建客户端逻辑: 编写 Go 代码来处理网络连接，包括：
处理本地 SOCKS 或 HTTP 代理请求。
将请求转发到 Xray 客户端的核心部分。
核心部分使用 VLESS 协议将数据加密并发送到远程服务器。
接收来自服务器的响应，并将其传回本地客户端。
关键技术点:
网络代理: 实现一个本地代理服务器（如 SOCKS 或 HTTP 代理），监听用户的本地网络请求。
流控和加密: 使用 Xray 提供的流控（如 XTLS）和加密方法来保证数据传输的效率和安全。
多路复用: 对于多个连接，可能需要使用 Go 语言的并发能力来处理。 
建议的开发流程：
选择库: 建议使用 xray-core，因为它包含了 v2ray-core 的所有功能，并且有性能上的优势。
熟悉协议: 深入阅读 VLESS 协议的文档，理解其通信机制，特别是与 Xray 核心的交互方式。
搭建开发环境: 使用 Go 语言的官方工具链，并安装好 xray-core 库。
编写代码:
先从简单的代理转发开始，然后逐步加入 VLESS 协议的细节。
考虑使用 v2ray-core 提供的 API 来简化 VLESS 协议的处理，而不是从头开始实现协议。
利用 Go 语言的并发模型（goroutines 和 channels）来处理多个连接


Xray Vless Client Main· go
package main


import (
	"context"
	"encoding/json"
	"flag"
	"fmt"
	"io"
	"log"
	"os"
	"os/exec"
	"os/signal"
	"path/filepath"
	"syscall"
	"time"
)


// This program is a pragmatic Go helper that *generates an xray-core JSON config*
// (inbound: local SOCKS5; outbound: VLESS to remote server) and launches the
// xray-core binary with that config. It is *not* a pure-Go reimplementation of
// xray/v2ray internals; embedding the core via library APIs is possible but
// considerably more complex and beyond a short example.
//
// Usage example:
//   go run main.go --server example.com --rport 443 --uuid 11111111-2222-3333-4444-555555555555 \
//       --xray ./xray --local-port 1080
//
// Requirements:
//  - xray-core binary available (pass path via --xray)
//  - Go 1.18+


func main() {
	server := flag.String("server", "127.0.0.1", "Remote Xray/VLESS server address")
	rport := flag.Int("rport", 443, "Remote Xray/VLESS server port")
	uuid := flag.String("uuid", "", "VLESS user UUID (required)")
	xrayPath := flag.String("xray", "xray", "Path to xray-core binary")
	localPort := flag.Int("local-port", 1080, "Local SOCKS5 listen port")
	useTLS := flag.Bool("tls", true, "Use TLS for streamSettings.security")
	insecureSkipVerify := flag.Bool("insecure", false, "Set tlsSettings.allowInsecure to true")
	flag.Parse()


	if *uuid == "" {
		log.Fatal("--uuid is required")
	}


	cfg := make(map[string]interface{})


	// inbound: a local socks proxy
	cfg["inbounds"] = []interface{}{map[string]interface{}{
		"port": *localPort,
		"listen": "127.0.0.1",
		"protocol": "socks",
		"settings": map[string]interface{}{
			"auth": "noauth",
			"udp": true,
		},
	}}


	// outbound: vless to remote
	vnext := []interface{}{map[string]interface{}{
		"address": *server,
		"port": *rport,
		"users": []interface{}{map[string]interface{}{
			"id": *uuid,
			"encryption": "none",
		}}}
	}


	outbound := map[string]interface{}{

我为你写好了一个实用的 Go 示例程序（文件名 xray_vless_client_main.go），它以可工程化、可运行的方式启动 Xray/Xray-core：
程序会根据你提供的远端服务器信息动态生成 xray-core 的 JSON 配置（本地 inbound：SOCKS5；outbound：VLESS），把配置写到临时文件，然后启动 xray-core 二进制进程并流式打印其日志。

说明：这是一个实用且低耦合的方式来“用 Go 管理/嵌入 Xray”。直接把 xray/v2ray 的底层 API 嵌入到 Go 程序（完全用库方式实现客户端核心）是可行的，但实现复杂且依赖内含的稳定 API。这个示例选择更稳妥且常见的做法：用 Go 生成配置并启动 xray-core 二进制，便于调试和迭代；同时在代码注释里也说明了进一步走内嵌库的方向。

我已把完整源码放到一个画布文件 xray_vless_client_main.go（Go 代码），你可以直接复制运行或用 go run 运行。主要特性与用法：

参数（命令行 flags）：

--server 远端 Xray/VLESS 服务器地址（默认 127.0.0.1）

--rport 远端端口（默认 443）

--uuid VLESS 用户 UUID（必填）

--xray xray-core 二进制路径（默认 xray，即需在 PATH 中或传入绝对路径）

--local-port 本地 SOCKS5 监听端口（默认 1080）

--tls 是否在 streamSettings 使用 TLS（默认 true）

--insecure tlsSettings.allowInsecure（默认 false）

运行后会：

生成一个包含 inbound(socks) 和 outbound(vless) 的 config.json

启动 xray-core -c config.json

将 xray 的 stdout/stderr 流式打印到当前进程

捕获 SIGINT/SIGTERM 并尝试优雅关闭 xray

如何使用（示例）：

go run xray_vless_client_main.go \
  --server your.xray.server.com \
  --rport 443 \
  --uuid 11111111-2222-3333-4444-555555555555 \
  --xray /path/to/xray \
  --local-port 1080